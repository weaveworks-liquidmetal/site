"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1539],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(n),m=o,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||a;return n?r.createElement(h,i(i({ref:t},c),{},{components:n})):r.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3773:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var r=n(7462),o=(n(7294),n(3905));const a={title:"Hardware"},i=void 0,l={unversionedId:"component-info/hardware",id:"component-info/hardware",title:"Hardware",description:"The metal requirements for running Flintlock hosts.",source:"@site/docs/component-info/hardware.md",sourceDirName:"component-info",slug:"/component-info/hardware",permalink:"/site/docs/component-info/hardware",draft:!1,editUrl:"https://github.com/weaveworks-liquidmetal/site/tree/main/docs/component-info/hardware.md",tags:[],version:"current",frontMatter:{title:"Hardware"},sidebar:"docs",previous:{title:"CAPMVM",permalink:"/site/docs/tutorial-rpi/troubleshooting/capmvm"},next:{title:"Networking",permalink:"/site/docs/component-info/networking"}},s={},p=[{value:"The <code>provision</code> tool",id:"the-provision-tool",level:2},{value:"Manual provisioning",id:"manual-provisioning",level:2},{value:"Storage",id:"storage",level:2}],c={toc:p},u="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The metal requirements for running Flintlock hosts."),(0,o.kt)("p",null,"Users are responsible for bringing and configuring their own hardware solutions."),(0,o.kt)("p",null,"Any hardware which can support KVM virtualisation can be used to host Liquid Metal\nMicroVMs."),(0,o.kt)("p",null,"So far we have tested on:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Equinix ",(0,o.kt)("inlineCode",{parentName:"li"},"x86")," devices"),(0,o.kt)("li",{parentName:"ul"},"Local workstations, such as Dell XPS"),(0,o.kt)("li",{parentName:"ul"},"Vagrant virtual machines running on macOS"),(0,o.kt)("li",{parentName:"ul"},"Raspberry Pi Model 4B ",(0,o.kt)("inlineCode",{parentName:"li"},"arm64")," boards")),(0,o.kt)("p",null,"The majority of our testing has been on ",(0,o.kt)("inlineCode",{parentName:"p"},"x86")," architectures, but we have also\nperformed demos with ARM devices."),(0,o.kt)("h2",{id:"the-provision-tool"},"The ",(0,o.kt)("inlineCode",{parentName:"h2"},"provision")," tool"),(0,o.kt)("p",null,"The recommended way to provision your devices is to use the ",(0,o.kt)("inlineCode",{parentName:"p"},"provision.sh")," tool."),(0,o.kt)("p",null,"The script and documentation can be found ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/weaveworks-liquidmetal/flintlock/tree/main/hack/scripts#provisionsh"},"here"),"."),(0,o.kt)("p",null,"The entire device can be provisioned with all required components with\n",(0,o.kt)("inlineCode",{parentName:"p"},"./provision.sh --all"),"."),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"./provision.sh --help")," for information on available commands."),(0,o.kt)("p",null,"If you are running Liquid Metal in production it is recommended that you attach\n",(0,o.kt)("a",{parentName:"p",href:"#storage"},"storage")," to each device acting as a host. If this is not possible, pass the ",(0,o.kt)("inlineCode",{parentName:"p"},"--dev"),"\nflag upon execution and sparse storage will be generated."),(0,o.kt)("h2",{id:"manual-provisioning"},"Manual provisioning"),(0,o.kt)("p",null,"If you would rather prepare your hosts manually or via your own tooling or automation,\nhere is a list of required packages and components:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"firecracker")," from ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/weaveworks/firecracker/releases"},"our supported fork"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/weaveworks-liquidmetal/flintlock/releases"},(0,o.kt)("inlineCode",{parentName:"a"},"flintlockd"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/containerd/containerd/releases"},(0,o.kt)("inlineCode",{parentName:"a"},"containerd"))),(0,o.kt)("li",{parentName:"ul"},"The host must be capable of running hardware accelerated KVM virtual machines"),(0,o.kt)("li",{parentName:"ul"},"Either the ",(0,o.kt)("inlineCode",{parentName:"li"},"macvtap")," module loaded in the kernel or a bridge network"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://docs.docker.com/storage/storagedriver/device-mapper-driver/"},"Devicemapper")," storage (see below)")),(0,o.kt)("h2",{id:"storage"},"Storage"),(0,o.kt)("p",null,"When provisioning hosts in ",(0,o.kt)("inlineCode",{parentName:"p"},"dev")," mode, no additional storage is required."),(0,o.kt)("p",null,"For production systems, an additional block device is required for ",(0,o.kt)("inlineCode",{parentName:"p"},"devmapper"),"\nstorage in ",(0,o.kt)("inlineCode",{parentName:"p"},"direct-lvm")," mode.\nThis storage will be used by ",(0,o.kt)("inlineCode",{parentName:"p"},"containerd")," to pull and snapshot MicroVM\nkernel and OS images, as well as to store MicroVM metadata."),(0,o.kt)("p",null,"A volume configured as a thin pool must be created on the device. The ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/weaveworks-liquidmetal/flintlock/tree/main/hack/scripts#provisionsh"},(0,o.kt)("inlineCode",{parentName:"a"},"provision.sh")),"\ntool has a subcommand to do this."),(0,o.kt)("p",null,"It can be called like so:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"./provision.sh direct_lvm --disk <disk name>\n")),(0,o.kt)("p",null,"If no disk is passed, the script will attempt to detect one which is available."),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"./provision.sh --help")," for all options."))}d.isMDXComponent=!0}}]);